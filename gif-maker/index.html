<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GIF ë§Œë“¤ê¸° â€“ ì´ë¯¸ì§€, ë™ì˜ìƒ, í™”ë©´ ë…¹í™”, í…ìŠ¤íŠ¸ GIF ìƒì„±ê¸°</title>
<meta name="description" content="ë¬´ë£Œ ì˜¨ë¼ì¸ GIF ìƒì„±ê¸°. NeuQuant ì‹ ê²½ë§ ìƒ‰ìƒ ìµœì í™”ë¡œ ê³ í’ˆì§ˆ GIFë¥¼ ë§Œë“œì„¸ìš”. ì´ë¯¸ì§€, ë™ì˜ìƒ(60ì´ˆ), í™”ë©´ ë…¹í™”, í…ìŠ¤íŠ¸ ì• ë‹ˆë©”ì´ì…˜ ì§€ì›.">
<meta name="keywords" content="GIF ë§Œë“¤ê¸°, GIF ìƒì„±ê¸°, ê³ í™”ì§ˆ GIF, ì´ë¯¸ì§€ GIF, ë™ì˜ìƒ GIF ë³€í™˜, í™”ë©´ ë…¹í™” GIF, í…ìŠ¤íŠ¸ GIF, ë¬´ë£Œ">
<link rel="canonical" href="https://webtoolbox.kr/gif-maker/">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#f6f7f9;--surface:#fff;--border:#e4e6eb;--text:#1a1c20;--text-sub:#5f6368;--text-muted:#9aa0a8;--accent:#2563eb;--accent-hover:#1d4ed8;--accent-light:#eff4ff;--green:#16a34a;--green-light:#dcfce7;--red:#dc2626;--red-light:#fef2f2;--shadow-sm:0 1px 3px rgba(0,0,0,.04),0 1px 2px rgba(0,0,0,.06);--radius:14px;--radius-sm:10px}
body{font-family:'Noto Sans KR',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;-webkit-font-smoothing:antialiased}
.nav{background:rgba(255,255,255,.92);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;backdrop-filter:blur(12px)}
.nav-inner{max-width:960px;margin:0 auto;padding:0 24px;height:60px;display:flex;align-items:center;gap:10px}
.nav-logo{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text)}
.nav-logo-icon{width:34px;height:34px;background:var(--accent);border-radius:9px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-family:'Outfit',sans-serif;font-size:16px}
.nav-logo-text{font-family:'Outfit',sans-serif;font-weight:700;font-size:18px}
.nav-sep{color:var(--border);font-size:20px;font-weight:300}
.nav-page{font-size:14px;color:var(--text-sub);font-weight:500}
.container{max-width:960px;margin:0 auto;padding:32px 24px 80px}
.page-header{text-align:center;margin-bottom:32px}
.page-header h1{font-family:'Outfit',sans-serif;font-size:32px;font-weight:700;letter-spacing:-.5px;margin-bottom:10px}
.page-header p{font-size:15px;color:var(--text-sub);max-width:560px;margin:0 auto}
.ad-slot{margin:24px 0}.ad-banner{background:var(--surface);border:1px dashed var(--border);border-radius:var(--radius-sm);min-height:90px;display:flex;align-items:center;justify-content:center;color:var(--text-muted);font-size:13px}
.tabs{display:flex;gap:4px;margin-bottom:20px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-sm);padding:4px;box-shadow:var(--shadow-sm);flex-wrap:wrap}
.tab{flex:1;min-width:110px;padding:10px 12px;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;font-family:'Noto Sans KR',sans-serif;transition:.15s;background:transparent;color:var(--text-muted);text-align:center}
.tab.active{background:var(--accent);color:#fff}.tab:not(.active):hover{background:var(--bg);color:var(--text-sub)}
.tab-icon{display:block;font-size:20px;margin-bottom:2px}
.panel{display:none}.panel.active{display:block}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin-bottom:16px;box-shadow:var(--shadow-sm)}
.dropzone{border:2px dashed var(--border);border-radius:var(--radius);padding:36px 24px;text-align:center;cursor:pointer;transition:.2s;margin-bottom:16px}
.dropzone:hover,.dropzone.dragover{border-color:var(--accent);background:var(--accent-light)}
.dropzone-icon{font-size:40px;margin-bottom:8px}.dropzone-text{font-size:15px;font-weight:600;margin-bottom:4px}.dropzone-sub{font-size:13px;color:var(--text-muted)}
.settings{display:flex;gap:14px;flex-wrap:wrap;align-items:center}
.setting{display:flex;align-items:center;gap:6px}
.setting label{font-size:12px;font-weight:600;color:var(--text-sub);white-space:nowrap}
.setting input[type=number],.setting select{padding:5px 8px;border:1px solid var(--border);border-radius:6px;font-size:12px;font-family:'JetBrains Mono',monospace;width:72px;outline:none}
.setting select{width:auto}
.sg{display:flex;flex-direction:column;gap:10px;width:100%}
.qp{display:flex;gap:6px;flex-wrap:wrap}
.qp-item{padding:6px 14px;border:2px solid var(--border);border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;transition:.15s;background:var(--surface)}
.qp-item:hover{border-color:var(--accent)}.qp-item.active{border-color:var(--accent);background:var(--accent-light);color:var(--accent)}
.qp-item .qp-sub{display:block;font-size:10px;font-weight:400;color:var(--text-muted);margin-top:2px}.qp-item.active .qp-sub{color:var(--accent)}
.btn{padding:8px 18px;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;font-family:'Noto Sans KR',sans-serif;transition:.15s}
.btn-primary{background:var(--accent);color:#fff}.btn-primary:hover{background:var(--accent-hover)}
.btn-green{background:var(--green);color:#fff}.btn-green:hover{background:#15803d}
.btn-red{background:var(--red-light);color:var(--red);border:1px solid #fecaca}.btn-red:hover{background:#fee2e2}
.btn-outline{background:var(--surface);color:var(--text-sub);border:1px solid var(--border)}.btn-outline:hover{border-color:var(--accent);color:var(--accent)}
.btn-lg{padding:12px 32px;font-size:15px;font-weight:700;border-radius:10px}
.btn:disabled{opacity:.5;cursor:not-allowed}
.btn-row{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin:16px 0}
.frame-list{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0;min-height:20px}
.frame-item{width:80px;height:80px;border-radius:8px;border:2px solid var(--border);overflow:hidden;position:relative;cursor:grab}
.frame-item img{width:100%;height:100%;object-fit:cover}
.frame-item .fr{position:absolute;top:2px;right:2px;width:20px;height:20px;background:rgba(0,0,0,.6);color:#fff;border:none;border-radius:50%;font-size:12px;cursor:pointer;display:flex;align-items:center;justify-content:center}
.frame-item .fn{position:absolute;bottom:2px;left:2px;background:rgba(0,0,0,.6);color:#fff;font-size:10px;padding:1px 5px;border-radius:3px;font-family:'JetBrains Mono',monospace}
.preview-area{text-align:center;margin:16px 0}.preview-area video{max-width:100%;max-height:280px;border-radius:var(--radius-sm);border:1px solid var(--border)}
.pw{margin:12px 0;display:none}.pw.show{display:block}
.pb{width:100%;height:8px;background:var(--border);border-radius:4px;overflow:hidden}.pf{height:100%;background:var(--accent);border-radius:4px;transition:width .15s}
.pt{font-size:13px;color:var(--text-sub);text-align:center;margin-top:6px}
.est{font-size:12px;color:var(--text-muted);text-align:center;margin-top:4px;font-style:italic}
.ra{text-align:center;margin:16px 0;display:none}.ra.show{display:block}
.ra img{max-width:100%;max-height:400px;border-radius:var(--radius-sm);border:1px solid var(--border);margin-bottom:12px}
.ri{font-size:13px;color:var(--text-sub);margin-bottom:12px}.ri strong{color:var(--text)}
.rec-dot{display:inline-block;width:10px;height:10px;background:var(--red);border-radius:50%;margin-right:6px;animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.text-preview-canvas{border:1px solid var(--border);border-radius:var(--radius-sm);margin:12px auto;display:block;max-width:100%}
.privacy{text-align:center;margin-top:24px;padding:14px;background:var(--green-light);border-radius:var(--radius-sm);font-size:13px;color:var(--green);font-weight:500}
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--text);color:#fff;padding:10px 20px;border-radius:8px;font-size:13px;font-weight:500;opacity:0;transition:.3s;z-index:999;pointer-events:none}.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.chk{display:flex;align-items:center;gap:6px;cursor:pointer;font-size:12px;font-weight:600;color:var(--text-sub)}.chk input{accent-color:var(--accent);width:16px;height:16px}
.vr{display:flex;align-items:center;gap:8px;margin-top:8px}.vr input[type=range]{flex:1;accent-color:var(--accent)}.vr span{font-size:12px;font-family:'JetBrains Mono',monospace;color:var(--text-sub);min-width:46px;text-align:center}
.faq-section{margin-top:48px}.faq-section h2{font-size:20px;font-weight:700;margin-bottom:20px}
.faq-item{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-sm);margin-bottom:10px;overflow:hidden}
.faq-q{padding:16px 20px;font-weight:500;font-size:15px;cursor:pointer;display:flex;justify-content:space-between;align-items:center}
.faq-q::after{content:'+';font-size:20px;color:var(--text-muted);transition:transform .2s}
.faq-item.open .faq-q::after{transform:rotate(45deg)}
.faq-a{max-height:0;overflow:hidden;transition:max-height .3s}
.faq-a-inner{padding:0 20px 16px;color:var(--text-sub);font-size:14px;line-height:1.8}
.faq-item.open .faq-a{max-height:400px}
@media(max-width:640px){.page-header h1{font-size:24px}.tab{min-width:70px;padding:8px 6px;font-size:11px}.frame-item{width:60px;height:60px}}
</style>
</head>
<body>
<nav class="nav"><div class="nav-inner">
  <a href="/" class="nav-logo"><div class="nav-logo-icon">U</div><span class="nav-logo-text">Utility</span></a>
  <span class="nav-sep">/</span><span class="nav-page">GIF ë§Œë“¤ê¸°</span>
</div></nav>

<div class="container">
  <div class="page-header">
    <h1>GIF ë§Œë“¤ê¸°</h1>
    <p>NeuQuant ì‹ ê²½ë§ ìƒ‰ìƒ ìµœì í™” + Floyd-Steinberg ë””ë”ë§ìœ¼ë¡œ ê³ í’ˆì§ˆ GIFë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë™ì˜ìƒ ìµœëŒ€ 60ì´ˆ, í™”ë©´ ë…¹í™”, í…ìŠ¤íŠ¸ ì• ë‹ˆë©”ì´ì…˜ì„ ì§€ì›í•©ë‹ˆë‹¤.</p>
  </div>
  <div class="ad-slot"><div class="ad-banner">ê´‘ê³  ì˜ì—­</div></div>

  <div class="tabs">
    <button class="tab active" onclick="switchTab('images')"><span class="tab-icon">ğŸ–¼ï¸</span>ì´ë¯¸ì§€ â†’ GIF</button>
    <button class="tab" onclick="switchTab('video')"><span class="tab-icon">ğŸ¬</span>ë™ì˜ìƒ â†’ GIF</button>
    <button class="tab" onclick="switchTab('screen')"><span class="tab-icon">ğŸ–¥ï¸</span>í™”ë©´ ë…¹í™”</button>
    <button class="tab" onclick="switchTab('text')"><span class="tab-icon">âœï¸</span>í…ìŠ¤íŠ¸ GIF</button>
  </div>

  <!-- 1. ì´ë¯¸ì§€ â†’ GIF -->
  <div class="panel active" id="panel-images">
    <div class="dropzone" id="imgDZ"><div class="dropzone-icon">ğŸ–¼ï¸</div><div class="dropzone-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì¶”ê°€</div><div class="dropzone-sub">PNG, JPG, WebP Â· ì—¬ëŸ¬ ì¥ ì„ íƒ Â· ë“œë˜ê·¸ë¡œ ìˆœì„œ ë³€ê²½</div><input type="file" id="imgIn" accept="image/*" multiple hidden></div>
    <div class="frame-list" id="imgFL"></div>
    <div class="card"><div class="sg">
      <div class="settings">
        <div class="setting"><label>ê°„ê²©</label><input type="number" id="imgDelay" value="500" min="20" max="5000" step="50"><label>ms</label></div>
        <div class="setting"><label>ë„ˆë¹„</label><input type="number" id="imgW" value="480" min="50" max="1200"><label>px</label></div>
        <div class="setting"><label>ë°˜ë³µ</label><select id="imgLoop"><option value="0">ë¬´í•œ</option><option value="1">1íšŒ</option><option value="3">3íšŒ</option></select></div>
        <label class="chk"><input type="checkbox" id="imgDither" checked>ë””ë”ë§</label>
      </div>
    </div></div>
    <div class="btn-row">
      <button class="btn btn-primary btn-lg" id="btnImgGen" disabled>GIF ìƒì„±</button>
      <button class="btn btn-red" id="btnImgClr" disabled>ì „ì²´ ì‚­ì œ</button>
    </div>
  </div>

  <!-- 2. ë™ì˜ìƒ â†’ GIF -->
  <div class="panel" id="panel-video">
    <div class="dropzone" id="vidDZ"><div class="dropzone-icon">ğŸ¬</div><div class="dropzone-text">ë™ì˜ìƒ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­</div><div class="dropzone-sub">MP4, WebM Â· ìµœëŒ€ 60ì´ˆ ì§€ì›</div><input type="file" id="vidIn" accept="video/mp4,video/webm,video/*" hidden></div>
    <div class="preview-area" id="vidPV"></div>
    <div id="vidCtrl" style="display:none"><div class="card"><div class="sg">
      <div style="font-size:13px;font-weight:700">êµ¬ê°„ ì„ íƒ</div>
      <div class="vr"><span id="vSL">0.0s</span><input type="range" id="vSR" value="0" min="0" step="0.1"><span>~</span><input type="range" id="vER" value="5" min="0.5" step="0.1"><span id="vEL">5.0s</span></div>
      <div style="text-align:center;font-size:12px;color:var(--text-muted)">êµ¬ê°„: <strong id="vDL">5.0ì´ˆ</strong> Â· í”„ë ˆì„: <strong id="vFC">50</strong>ê°œ Â· ì˜ˆìƒ í¬ê¸°: <strong id="vES">~3MB</strong></div>
      <div class="settings" style="margin-top:8px">
        <div class="setting"><label>FPS</label><select id="vidFps"><option value="5">5</option><option value="8">8</option><option value="10" selected>10</option><option value="12">12</option><option value="15">15</option><option value="20">20</option></select></div>
        <div class="setting"><label>ë„ˆë¹„</label><input type="number" id="vidW" value="480" min="100" max="1200"><label>px</label></div>
        <label class="chk"><input type="checkbox" id="vidDither" checked>ë””ë”ë§</label>
        <label class="chk"><input type="checkbox" id="vidGlobal" checked>ê¸€ë¡œë²Œ íŒ”ë ˆíŠ¸</label>
      </div>
      <div style="margin-top:8px">
        <div style="font-size:12px;font-weight:600;color:var(--text-sub);margin-bottom:6px">í’ˆì§ˆ í”„ë¦¬ì…‹</div>
        <div class="qp" id="vidQP">
          <div class="qp-item" data-w="320" data-fps="8">ë¹ ë¥¸ ë³€í™˜<span class="qp-sub">320pxÂ·8fps</span></div>
          <div class="qp-item active" data-w="480" data-fps="10">ê· í˜•<span class="qp-sub">480pxÂ·10fps</span></div>
          <div class="qp-item" data-w="640" data-fps="12">ê³ í™”ì§ˆ<span class="qp-sub">640pxÂ·12fps</span></div>
          <div class="qp-item" data-w="800" data-fps="15">ìµœê³ í™”ì§ˆ<span class="qp-sub">800pxÂ·15fps</span></div>
        </div>
      </div>
    </div></div>
    <div class="btn-row"><button class="btn btn-primary btn-lg" id="btnVidGen">GIF ìƒì„±</button></div>
    </div>
  </div>

  <!-- 3. í™”ë©´ ë…¹í™” -->
  <div class="panel" id="panel-screen">
    <div class="card" style="text-align:center">
      <p style="margin-bottom:14px;color:var(--text-sub);font-size:14px">í™”ë©´/ì°½/íƒ­ì„ ë…¹í™”í•˜ì—¬ GIFë¡œ ë³€í™˜í•©ë‹ˆë‹¤</p>
      <div class="settings" style="justify-content:center">
        <div class="setting"><label>ìµœëŒ€</label><input type="number" id="scrDur" value="10" min="1" max="30"><label>ì´ˆ</label></div>
        <div class="setting"><label>FPS</label><select id="scrFps"><option value="5">5</option><option value="8" selected>8</option><option value="10">10</option></select></div>
        <div class="setting"><label>ë„ˆë¹„</label><input type="number" id="scrW" value="640" min="200" max="1200"><label>px</label></div>
        <label class="chk"><input type="checkbox" id="scrDither" checked>ë””ë”ë§</label>
      </div>
      <div class="btn-row">
        <button class="btn btn-primary btn-lg" id="btnScrGo">ë…¹í™” ì‹œì‘</button>
        <button class="btn btn-red btn-lg" id="btnScrStop" style="display:none"><span class="rec-dot"></span>ë…¹í™” ì¤‘ì§€</button>
      </div>
      <div id="scrStat" style="font-size:13px;color:var(--text-muted);margin-top:8px"></div>
    </div>
  </div>

  <!-- 4. í…ìŠ¤íŠ¸ GIF -->
  <div class="panel" id="panel-text">
    <div class="card"><div class="sg">
      <div class="setting" style="width:100%"><label style="min-width:50px">í…ìŠ¤íŠ¸</label><input type="text" id="txtC" value="ì•ˆë…•í•˜ì„¸ìš”!" style="flex:1;width:auto;padding:8px 12px;font-size:15px;border:1px solid var(--border);border-radius:6px;font-family:'Noto Sans KR',sans-serif" maxlength="30"></div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <div class="setting"><label>íš¨ê³¼</label><select id="txtFx"><option value="typewriter">íƒ€ì´í•‘</option><option value="bounce">ë°”ìš´ìŠ¤</option><option value="fade">í˜ì´ë“œì¸</option><option value="rainbow">ë ˆì¸ë³´ìš°</option><option value="shake">í”ë“¤ê¸°</option><option value="slide">ìŠ¬ë¼ì´ë“œ</option><option value="glow">ê¸€ë¡œìš°</option><option value="wave">ì›¨ì´ë¸Œ</option></select></div>
        <div class="setting"><label>í¬ê¸°</label><input type="number" id="txtSz" value="48" min="16" max="120"><label>px</label></div>
        <div class="setting"><label>ê¸€ê¼´ìƒ‰</label><input type="color" id="txtClr" value="#ffffff" style="width:36px;height:28px;border:1px solid var(--border);border-radius:4px;cursor:pointer"></div>
        <div class="setting"><label>ë°°ê²½</label><input type="color" id="txtBg" value="#2563eb" style="width:36px;height:28px;border:1px solid var(--border);border-radius:4px;cursor:pointer"></div>
        <div class="setting"><label>W</label><input type="number" id="txtW" value="480" min="200" max="1200"></div>
        <div class="setting"><label>H</label><input type="number" id="txtH" value="180" min="80" max="600"></div>
      </div>
    </div></div>
    <div style="text-align:center"><canvas id="txtPV" class="text-preview-canvas" width="480" height="180"></canvas></div>
    <div class="btn-row">
      <button class="btn btn-outline" id="btnTxtPV">ë¯¸ë¦¬ë³´ê¸°</button>
      <button class="btn btn-primary btn-lg" id="btnTxtGen">GIF ìƒì„±</button>
    </div>
  </div>

  <div class="pw" id="pw"><div class="pb"><div class="pf" id="pf" style="width:0%"></div></div><div class="pt" id="pt"></div><div class="est" id="estTime"></div></div>
  <div class="ra" id="ra"><img id="rImg" src=""><div class="ri" id="rInfo"></div><div class="btn-row"><button class="btn btn-green btn-lg" id="btnDL">ë‹¤ìš´ë¡œë“œ</button></div></div>

  <div class="privacy">ğŸ”’ ì„œë²„ ì „ì†¡ ì—†ìŒ â€“ ëª¨ë“  ì²˜ë¦¬ëŠ” 100% ë¸Œë¼ìš°ì €ì—ì„œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤</div>
  <div class="ad-slot"><div class="ad-banner">ê´‘ê³  ì˜ì—­</div></div>

  <div class="faq-section">
    <h2>ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)</h2>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">NeuQuantê°€ ë­”ê°€ìš”?</div><div class="faq-a"><div class="faq-a-inner">Anthony Dekkerê°€ ê°œë°œí•œ ì‹ ê²½ë§ ê¸°ë°˜ ìƒ‰ìƒ ì–‘ìí™” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. GIFëŠ” ìµœëŒ€ 256ìƒ‰ë§Œ í‘œì‹œ ê°€ëŠ¥í•œë°, NeuQuantëŠ” ì´ë¯¸ì§€ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ 256ê°€ì§€ ìƒ‰ìƒì„ í•™ìŠµí•˜ì—¬ ìµœì ì˜ íŒ”ë ˆíŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. Median Cut ë°©ì‹ë³´ë‹¤ ê·¸ë¼ë°ì´ì…˜ê³¼ ì‚¬ì§„ì—ì„œ í›¨ì”¬ ìì—°ìŠ¤ëŸ¬ìš´ ê²°ê³¼ë¥¼ ë§Œë“­ë‹ˆë‹¤.</div></div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">ê¸€ë¡œë²Œ íŒ”ë ˆíŠ¸ë€?</div><div class="faq-a"><div class="faq-a-inner">ë™ì˜ìƒì˜ ëª¨ë“  í”„ë ˆì„ì—ì„œ ìƒ‰ìƒì„ ìƒ˜í”Œë§í•˜ì—¬ í•˜ë‚˜ì˜ í†µí•© íŒ”ë ˆíŠ¸ë¥¼ ë§Œë“œëŠ” ë°©ì‹ì…ë‹ˆë‹¤. í”„ë ˆì„ë§ˆë‹¤ ìƒ‰ìƒì´ ë‹¬ë¼ì§€ëŠ” ê¹œë¹¡ì„ í˜„ìƒì„ ë°©ì§€í•˜ê³ , íŒŒì¼ í¬ê¸°ë„ ì¤„ì–´ë“­ë‹ˆë‹¤.</div></div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">íŒŒì¼ í¬ê¸°ë¥¼ ì¤„ì´ë ¤ë©´?</div><div class="faq-a"><div class="faq-a-inner">â‘  ë„ˆë¹„ë¥¼ 320~480pxë¡œ ì¤„ì´ì„¸ìš”. â‘¡ FPSë¥¼ 8 ì´í•˜ë¡œ ë‚®ì¶”ì„¸ìš”. â‘¢ êµ¬ê°„ì„ ì§§ê²Œ ì„¤ì •í•˜ì„¸ìš”. â‘£ ë””ë”ë§ì„ ë„ë©´ LZW ì••ì¶•ë¥ ì´ ë†’ì•„ì ¸ íŒŒì¼ì´ ì‘ì•„ì§‘ë‹ˆë‹¤. "ë¹ ë¥¸ ë³€í™˜" í”„ë¦¬ì…‹ì„ ì‚¬ìš©í•´ ë³´ì„¸ìš”.</div></div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">ì²˜ë¦¬ê°€ ëŠë¦° ê²½ìš°</div><div class="faq-a"><div class="faq-a-inner">GIF ì¸ì½”ë”©ì€ Web Workerì—ì„œ ë³„ë„ë¡œ ì²˜ë¦¬ë˜ì–´ ë¸Œë¼ìš°ì €ê°€ ë©ˆì¶”ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê³ í•´ìƒë„ + ë§ì€ í”„ë ˆì„ì€ ì‹œê°„ì´ ê±¸ë¦½ë‹ˆë‹¤. ë¨¼ì € "ë¹ ë¥¸ ë³€í™˜"ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í›„ í’ˆì§ˆì„ ì˜¬ë¦¬ì„¸ìš”. 800pxÂ·15fpsÂ·30ì´ˆ = 450í”„ë ˆì„ìœ¼ë¡œ 1~3ë¶„ ì†Œìš”ë©ë‹ˆë‹¤.</div></div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">í™”ë©´ ë…¹í™”ê°€ ì•ˆ ë¼ìš”</div><div class="faq-a"><div class="faq-a-inner">Chrome, Edge, Firefoxì—ì„œ ì§€ì›ë©ë‹ˆë‹¤. SafariëŠ” ì œí•œì ì…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ í™”ë©´ ê³µìœ  ê¶Œí•œì„ í—ˆìš©í•´ì•¼ í•©ë‹ˆë‹¤.</div></div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">ë””ë”ë§ì„ ë„ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?</div><div class="faq-a"><div class="faq-a-inner">ë””ë”ë§(Floyd-Steinberg)ì€ ìƒ‰ìƒ ê²½ê³„ë¥¼ ë¶€ë“œëŸ½ê²Œ ë§Œë“¤ì§€ë§Œ ë…¸ì´ì¦ˆ íŒ¨í„´ì´ ìƒê¹ë‹ˆë‹¤. ë¡œê³ ë‚˜ í…ìŠ¤íŠ¸ì²˜ëŸ¼ ë‹¨ìƒ‰ì´ ë§ì€ ì´ë¯¸ì§€ì—ì„œëŠ” ë„ëŠ” ê²ƒì´ ë” ì„ ëª…í•˜ê³  íŒŒì¼ í¬ê¸°ë„ ì‘ìŠµë‹ˆë‹¤.</div></div></div>
  </div>
  <div class="ad-slot"><div class="ad-banner">ê´‘ê³  ì˜ì—­</div></div>
</div>
<div class="toast" id="toast"></div>

<script>
// ================================================================
//  GIF Encoder Web Worker (runs in separate thread)
//  Contains: NeuQuant neural network quantizer + LZW + GIF89a builder
// ================================================================
const WORKER_CODE = `
// ---- NeuQuant Neural Network Color Quantizer ----
// Based on Anthony Dekker's NeuQuant algorithm (1994)
// Adapted for inline Web Worker usage

const ncycles = 100;
const netsize = 256;
const maxnetpos = netsize - 1;
const netbiasshift = 4;
const intbiasshift = 16;
const intbias = (1 << intbiasshift);
const gammashift = 10;
const betashift = 10;
const beta = (intbias >> betashift);
const betagamma = (intbias << (gammashift - betashift));
const initrad = (netsize >> 3) * (1 << 6);
const radiusbiasshift = 6;
const radiusbias = (1 << radiusbiasshift);
const initradius = (initrad / radiusbias);
const radiusdec = 30;
const alphabiasshift = 10;
const initalpha = (1 << alphabiasshift);
const radbiasshift = 8;
const radpower = new Int32Array(initrad);
const alphadec_default = 30;

class NeuQuant {
  constructor(pixels, samplefac) {
    this.pixels = pixels;
    this.samplefac = samplefac || 10;
    this.network = [];
    this.netindex = new Int32Array(256);
    this.bias = new Int32Array(netsize);
    this.freq = new Int32Array(netsize);
    this.init();
  }

  init() {
    for (let i = 0; i < netsize; i++) {
      const v = (i << (netbiasshift + 8)) / netsize;
      this.network[i] = [v, v, v, 0];
      this.freq[i] = intbias / netsize;
      this.bias[i] = 0;
    }
  }

  unbiasnet() {
    for (let i = 0; i < netsize; i++) {
      this.network[i][0] >>= netbiasshift;
      this.network[i][1] >>= netbiasshift;
      this.network[i][2] >>= netbiasshift;
      this.network[i][3] = i;
    }
  }

  altersingle(alpha, i, b, g, r) {
    const n = this.network[i];
    n[0] -= (alpha * (n[0] - b)) / initalpha;
    n[1] -= (alpha * (n[1] - g)) / initalpha;
    n[2] -= (alpha * (n[2] - r)) / initalpha;
  }

  alterneigh(rad, i, b, g, r) {
    const lo = Math.max(i - rad, -1);
    const hi = Math.min(i + rad, netsize);
    let j = i + 1, k = i - 1, m = 1;
    while (j < hi || k > lo) {
      const a = radpower[m++];
      if (j < hi) {
        const p = this.network[j++];
        p[0] -= (a * (p[0] - b)) / (1 << (alphabiasshift + radbiasshift));
        p[1] -= (a * (p[1] - g)) / (1 << (alphabiasshift + radbiasshift));
        p[2] -= (a * (p[2] - r)) / (1 << (alphabiasshift + radbiasshift));
      }
      if (k > lo) {
        const p = this.network[k--];
        p[0] -= (a * (p[0] - b)) / (1 << (alphabiasshift + radbiasshift));
        p[1] -= (a * (p[1] - g)) / (1 << (alphabiasshift + radbiasshift));
        p[2] -= (a * (p[2] - r)) / (1 << (alphabiasshift + radbiasshift));
      }
    }
  }

  contest(b, g, r) {
    let bestd = ~(1 << 31), bestbiasd = bestd, bestpos = -1, bestbiaspos = bestpos;
    for (let i = 0; i < netsize; i++) {
      const n = this.network[i];
      let dist = Math.abs(n[0] - b) + Math.abs(n[1] - g) + Math.abs(n[2] - r);
      if (dist < bestd) { bestd = dist; bestpos = i; }
      let biasdist = dist - ((this.bias[i]) >> (intbiasshift - netbiasshift));
      if (biasdist < bestbiasd) { bestbiasd = biasdist; bestbiaspos = i; }
      let betafreq = (this.freq[i] >> betashift);
      this.freq[i] -= betafreq;
      this.bias[i] += (betafreq << gammashift);
    }
    this.freq[bestpos] += beta;
    this.bias[bestpos] -= betagamma;
    return bestbiaspos;
  }

  learn() {
    const pixels = this.pixels;
    const len = pixels.length;
    const alphadec = alphadec_default + ((this.samplefac - 1) / 3);
    const samplepixels = (len / (4 * this.samplefac)) | 0;
    let delta = Math.max(1, (samplepixels / ncycles) | 0);
    let alpha = initalpha;
    let radius = initradius;
    let rad = radius >> radiusbiasshift;
    if (rad <= 1) rad = 0;
    for (let i = 0; i < rad; i++) radpower[i] = alpha * (((rad * rad - i * i) * (1 << radbiasshift)) / (rad * rad));
    let step;
    if (len < 512) step = 4;
    else if (len < 2048) step = 4;
    else step = 4 * this.samplefac;
    let pix = 0;
    for (let i = 0; i < samplepixels;) {
      const b = (pixels[pix] & 0xFF) << netbiasshift;
      const g = (pixels[pix + 1] & 0xFF) << netbiasshift;
      const r = (pixels[pix + 2] & 0xFF) << netbiasshift;
      const j = this.contest(b, g, r);
      this.altersingle(alpha, j, b, g, r);
      if (rad !== 0) this.alterneigh(rad, j, b, g, r);
      pix += step;
      if (pix >= len) pix -= len;
      i++;
      if (delta === 0) delta = 1;
      if (i % delta === 0) {
        alpha -= alpha / alphadec;
        radius -= radius / radiusdec;
        rad = radius >> radiusbiasshift;
        if (rad <= 1) rad = 0;
        for (let k = 0; k < rad; k++) radpower[k] = alpha * (((rad * rad - k * k) * (1 << radbiasshift)) / (rad * rad));
      }
    }
  }

  buildIndex() {
    let prev = 0;
    for (let i = 0; i < netsize; i++) {
      let smallpos = i, smallval = this.network[i][1];
      for (let j = i + 1; j < netsize; j++) {
        if (this.network[j][1] < smallval) { smallpos = j; smallval = this.network[j][1]; }
      }
      if (i !== smallpos) { let t = this.network[i]; this.network[i] = this.network[smallpos]; this.network[smallpos] = t; }
      if (smallval !== prev) {
        this.netindex[prev] = ((i + prev) >> 1) | 0;
        for (let j = prev + 1; j < smallval; j++) this.netindex[j] = i;
        prev = smallval;
      }
      this.netindex[prev] = i;
    }
    for (let j = prev + 1; j < 256; j++) this.netindex[j] = maxnetpos;
  }

  lookupRGB(b, g, r) {
    let bestd = 1000, best = -1;
    let i = this.netindex[g];
    let j = i - 1;
    while (i < netsize || j >= 0) {
      if (i < netsize) {
        const p = this.network[i];
        let dist = p[1] - g;
        if (dist >= bestd) i = netsize;
        else {
          i++;
          if (dist < 0) dist = -dist;
          let a = p[0] - b; if (a < 0) a = -a; dist += a;
          if (dist < bestd) { a = p[2] - r; if (a < 0) a = -a; dist += a; if (dist < bestd) { bestd = dist; best = p[3]; } }
        }
      }
      if (j >= 0) {
        const p = this.network[j];
        let dist = g - p[1];
        if (dist >= bestd) j = -1;
        else {
          j--;
          if (dist < 0) dist = -dist;
          let a = p[0] - b; if (a < 0) a = -a; dist += a;
          if (dist < bestd) { a = p[2] - r; if (a < 0) a = -a; dist += a; if (dist < bestd) { bestd = dist; best = p[3]; } }
        }
      }
    }
    return best;
  }

  process() {
    this.learn();
    this.unbiasnet();
    this.buildIndex();
    return this.buildPalette();
  }

  buildPalette() {
    const palette = new Uint8Array(256 * 3);
    const map = [];
    for (let i = 0; i < netsize; i++) {
      const idx = this.network[i][3];
      palette[idx * 3] = this.network[i][0] & 0xFF;
      palette[idx * 3 + 1] = this.network[i][1] & 0xFF;
      palette[idx * 3 + 2] = this.network[i][2] & 0xFF;
      map[i] = this.network[i];
    }
    return { palette, nq: this };
  }
}

// ---- Floyd-Steinberg Dithering + Index Mapping ----
function mapPixels(pixels, w, h, palette, nq, dither) {
  const indexed = new Uint8Array(w * h);
  if (!dither) {
    for (let i = 0; i < w * h; i++) {
      const o = i * 4;
      indexed[i] = nq.lookupRGB(pixels[o], pixels[o+1], pixels[o+2]);
    }
    return indexed;
  }
  const pix = new Int16Array(pixels.length);
  for (let i = 0; i < pixels.length; i++) pix[i] = pixels[i];
  for (let y = 0; y < h; y++) {
    for (let x = 0; x < w; x++) {
      const i = y * w + x, o = i * 4;
      const r = Math.max(0, Math.min(255, pix[o]));
      const g = Math.max(0, Math.min(255, pix[o+1]));
      const b = Math.max(0, Math.min(255, pix[o+2]));
      const best = nq.lookupRGB(r, g, b);
      indexed[i] = best;
      const er = r - palette[best*3], eg = g - palette[best*3+1], eb = b - palette[best*3+2];
      if (x+1<w){const n=o+4;pix[n]+=er*7>>4;pix[n+1]+=eg*7>>4;pix[n+2]+=eb*7>>4;}
      if (y+1<h){
        if(x>0){const n=o+w*4-4;pix[n]+=er*3>>4;pix[n+1]+=eg*3>>4;pix[n+2]+=eb*3>>4;}
        {const n=o+w*4;pix[n]+=er*5>>4;pix[n+1]+=eg*5>>4;pix[n+2]+=eb*5>>4;}
        if(x+1<w){const n=o+w*4+4;pix[n]+=er>>4;pix[n+1]+=eg>>4;pix[n+2]+=eb>>4;}
      }
    }
  }
  return indexed;
}

// ---- LZW Encoding ----
function lzwEncode(indexed, minCodeSize) {
  const cc = 1 << minCodeSize, eoi = cc + 1;
  let codeSize = minCodeSize + 1, next = eoi + 1;
  const out = []; let cur = 0, bits = 0;
  const emit = (code, sz) => { cur |= (code << bits); bits += sz; while (bits >= 8) { out.push(cur & 0xFF); cur >>= 8; bits -= 8; } };
  let table = new Map();
  const reset = () => { table = new Map(); for (let i = 0; i < cc; i++) table.set(String(i), i); codeSize = minCodeSize + 1; next = eoi + 1; };
  reset(); emit(cc, codeSize);
  let s = String(indexed[0]);
  for (let i = 1; i < indexed.length; i++) {
    const k = s + ',' + indexed[i];
    if (table.has(k)) { s = k; }
    else {
      emit(table.get(s), codeSize);
      if (next < 4096) { table.set(k, next); next++; if (next > (1 << codeSize) && codeSize < 12) codeSize++; }
      else { emit(cc, codeSize); reset(); }
      s = String(indexed[i]);
    }
  }
  emit(table.get(s), codeSize);
  emit(eoi, codeSize);
  if (bits > 0) out.push(cur & 0xFF);
  return out;
}

// ---- GIF89a Binary Builder ----
function buildGIF(frames, w, h, repeat) {
  const o = [];
  const ws = (s) => { for (let i = 0; i < s.length; i++) o.push(s.charCodeAt(i)); };
  const w16 = (v) => { o.push(v & 0xFF); o.push((v >> 8) & 0xFF); };
  ws('GIF89a'); w16(w); w16(h);
  o.push(0x70, 0, 0);
  ws('\\x21\\xFF\\x0BNETSCAPE2.0');
  o.push(3, 1); w16(repeat); o.push(0);
  for (const f of frames) {
    o.push(0x21, 0xF9, 4, 0x04);
    w16(Math.round(f.delay / 10));
    o.push(0, 0, 0x2C);
    w16(0); w16(0); w16(w); w16(h);
    o.push(0x87);
    for (let i = 0; i < 256; i++) { o.push(f.palette[i*3]||0); o.push(f.palette[i*3+1]||0); o.push(f.palette[i*3+2]||0); }
    const minCode = 8; o.push(minCode);
    const lzw = lzwEncode(f.indexed, minCode);
    let off = 0;
    while (off < lzw.length) { const sz = Math.min(255, lzw.length - off); o.push(sz); for (let i = 0; i < sz; i++) o.push(lzw[off + i]); off += sz; }
    o.push(0);
  }
  o.push(0x3B);
  return new Uint8Array(o);
}

// ---- Worker Message Handler ----
self.onmessage = function(e) {
  const { type, frameDataList, w, h, delays, repeat, dither, samplefac, globalPalette: useGlobal } = e.data;
  const totalFrames = frameDataList.length;

  let globalNQ = null, globalPal = null;
  if (useGlobal) {
    // Build global palette from sampled pixels across all frames
    const samplePerFrame = Math.max(1, Math.floor(10000 / totalFrames));
    const sampled = [];
    for (const fd of frameDataList) {
      const step = Math.max(1, Math.floor(fd.length / 4 / samplePerFrame));
      for (let i = 0; i < fd.length; i += step * 4) {
        sampled.push(fd[i], fd[i+1], fd[i+2], fd[i+3]);
      }
    }
    const nq = new NeuQuant(new Uint8Array(sampled), samplefac || 10);
    const result = nq.process();
    globalNQ = result.nq;
    globalPal = result.palette;
    self.postMessage({ type: 'progress', frame: 0, total: totalFrames, phase: 'palette' });
  }

  const gifFrames = [];
  for (let i = 0; i < totalFrames; i++) {
    const pixels = frameDataList[i];
    let palette, nq;
    if (useGlobal) {
      palette = globalPal;
      nq = globalNQ;
    } else {
      const neuquant = new NeuQuant(pixels, samplefac || 10);
      const result = neuquant.process();
      palette = result.palette;
      nq = result.nq;
    }
    const indexed = mapPixels(pixels, w, h, palette, nq, dither);
    gifFrames.push({ palette, indexed, delay: delays[i] || delays[0] });
    self.postMessage({ type: 'progress', frame: i + 1, total: totalFrames, phase: 'encode' });
  }

  const gifData = buildGIF(gifFrames, w, h, repeat);
  self.postMessage({ type: 'done', data: gifData.buffer }, [gifData.buffer]);
};
`;

// Create Blob Worker
const workerBlob = new Blob([WORKER_CODE], { type: 'application/javascript' });
const workerUrl = URL.createObjectURL(workerBlob);

function createWorker() { return new Worker(workerUrl); }

// ================================================================
//  UI Helpers
// ================================================================
const $=id=>document.getElementById(id);
let resultBlob=null;

function switchTab(n){
  document.querySelectorAll('.tab').forEach((t,i)=>t.classList.toggle('active',['images','video','screen','text'][i]===n));
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  $('panel-'+n).classList.add('active');
  $('ra').classList.remove('show');$('pw').classList.remove('show');
}
function showP(pct,txt,est){$('pw').classList.add('show');$('pf').style.width=pct+'%';$('pt').textContent=txt||'';$('estTime').textContent=est||'';}
function hideP(){$('pw').classList.remove('show');}
function showResult(blob){
  resultBlob=blob;$('rImg').src=URL.createObjectURL(blob);
  $('rInfo').innerHTML=`<strong>í¬ê¸°:</strong> ${fmtSz(blob.size)} Â· <strong>í”„ë ˆì„:</strong> ì¸ì½”ë”© ì™„ë£Œ`;
  $('ra').classList.add('show');hideP();showToast('GIF ìƒì„± ì™„ë£Œ!');
  $('ra').scrollIntoView({behavior:'smooth',block:'center'});
}
$('btnDL').onclick=()=>{if(!resultBlob)return;const a=document.createElement('a');a.href=URL.createObjectURL(resultBlob);a.download='animation.gif';a.click();};
function fmtSz(b){if(b<1024)return b+'B';if(b<1048576)return(b/1024).toFixed(1)+'KB';return(b/1048576).toFixed(2)+'MB';}
function showToast(m){const t=$('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500);}
function yld(){return new Promise(r=>setTimeout(r,0));}

function encodeWithWorker(frameDataList, w, h, delays, repeat, dither, useGlobal, samplefac) {
  return new Promise((resolve, reject) => {
    const worker = createWorker();
    const startTime = Date.now();
    worker.onmessage = e => {
      if (e.data.type === 'progress') {
        const { frame, total, phase } = e.data;
        const pct = phase === 'palette' ? 5 : 5 + Math.round((frame / total) * 95);
        const elapsed = ((Date.now() - startTime) / 1000).toFixed(0);
        const eta = frame > 0 ? Math.round(((Date.now() - startTime) / frame) * (total - frame) / 1000) : '';
        const etaStr = eta ? `ì˜ˆìƒ ë‚¨ì€ ì‹œê°„: ~${eta}ì´ˆ` : '';
        showP(pct, phase === 'palette' ? 'ê¸€ë¡œë²Œ íŒ”ë ˆíŠ¸ ìƒì„± ì¤‘...' : `ì¸ì½”ë”© ${frame}/${total} í”„ë ˆì„ (${elapsed}ì´ˆ ê²½ê³¼)`, etaStr);
      } else if (e.data.type === 'done') {
        worker.terminate();
        resolve(new Blob([e.data.data], { type: 'image/gif' }));
      }
    };
    worker.onerror = e => { worker.terminate(); reject(e); };
    // Transfer ArrayBuffers for zero-copy
    const transferable = frameDataList.map(fd => fd.buffer);
    worker.postMessage({ frameDataList, w, h, delays, repeat, dither, samplefac: samplefac || 10, globalPalette: useGlobal }, transferable);
  });
}

// Extract ImageData from canvas array
function canvasToPixelData(canvases, w, h) {
  return canvases.map(c => {
    const ctx = c.getContext('2d');
    return new Uint8Array(ctx.getImageData(0, 0, w, h).data);
  });
}

// ===== 1. ì´ë¯¸ì§€ â†’ GIF =====
const imgFrames=[];
const imgDZ=$('imgDZ'),imgIn=$('imgIn'),imgFL=$('imgFL');
imgDZ.onclick=()=>imgIn.click();
imgDZ.ondragover=e=>{e.preventDefault();imgDZ.classList.add('dragover');};
imgDZ.ondragleave=()=>imgDZ.classList.remove('dragover');
imgDZ.ondrop=e=>{e.preventDefault();imgDZ.classList.remove('dragover');addImgs(e.dataTransfer.files);};
imgIn.onchange=()=>{addImgs(imgIn.files);imgIn.value='';};

function addImgs(files){
  [...files].filter(f=>f.type.startsWith('image/')).forEach(f=>{
    const r=new FileReader();r.onload=e=>{const img=new Image();img.onload=()=>{imgFrames.push({img,src:e.target.result});renderImgs();};img.src=e.target.result;};r.readAsDataURL(f);
  });
}
function renderImgs(){
  imgFL.innerHTML=imgFrames.map((f,i)=>`<div class="frame-item" draggable="true" data-idx="${i}"><img src="${f.src}"><button class="fr" onclick="event.stopPropagation();rmImg(${i})">Ã—</button><span class="fn">${i+1}</span></div>`).join('');
  $('btnImgGen').disabled=imgFrames.length<2;$('btnImgClr').disabled=imgFrames.length===0;
  imgFL.querySelectorAll('.frame-item').forEach(el=>{
    el.ondragstart=e=>e.dataTransfer.setData('text/plain',el.dataset.idx);
    el.ondragover=e=>e.preventDefault();
    el.ondrop=e=>{e.preventDefault();const f=+e.dataTransfer.getData('text/plain'),t=+el.dataset.idx;if(f!==t){imgFrames.splice(t,0,imgFrames.splice(f,1)[0]);renderImgs();}};
  });
}
window.rmImg=i=>{imgFrames.splice(i,1);renderImgs();};
$('btnImgClr').onclick=()=>{imgFrames.length=0;renderImgs();};

$('btnImgGen').onclick=async()=>{
  if(imgFrames.length<2)return;
  const w=+$('imgW').value,delay=+$('imgDelay').value,repeat=+$('imgLoop').value,dither=$('imgDither').checked;
  $('ra').classList.remove('show');showP(0,'í”„ë ˆì„ ì¤€ë¹„ ì¤‘...');
  const cs=imgFrames.map(f=>{const r=f.img.naturalHeight/f.img.naturalWidth,h=Math.round(w*r),c=document.createElement('canvas');c.width=w;c.height=h;c.getContext('2d').drawImage(f.img,0,0,w,h);return c;});
  const maxH=Math.max(...cs.map(c=>c.height));
  const fin=cs.map(c=>{if(c.height===maxH)return c;const nc=document.createElement('canvas');nc.width=w;nc.height=maxH;const ctx=nc.getContext('2d');ctx.fillStyle='#000';ctx.fillRect(0,0,w,maxH);ctx.drawImage(c,0,Math.floor((maxH-c.height)/2));return nc;});
  showP(5,'í”½ì…€ ë°ì´í„° ì¶”ì¶œ ì¤‘...');await yld();
  const pixelData=canvasToPixelData(fin,w,maxH);
  const delays=new Array(fin.length).fill(delay);
  try{
    const blob=await encodeWithWorker(pixelData,w,maxH,delays,repeat,dither,imgFrames.length>3,10);
    showResult(blob);
  }catch(e){hideP();showToast('ì˜¤ë¥˜: '+e.message);}
};

// ===== 2. ë™ì˜ìƒ â†’ GIF =====
const vidDZ=$('vidDZ'),vidIn=$('vidIn');let vidEl=null;
vidDZ.onclick=()=>vidIn.click();
vidDZ.ondragover=e=>{e.preventDefault();vidDZ.classList.add('dragover');};
vidDZ.ondragleave=()=>vidDZ.classList.remove('dragover');
vidDZ.ondrop=e=>{e.preventDefault();vidDZ.classList.remove('dragover');if(e.dataTransfer.files[0])loadVid(e.dataTransfer.files[0]);};
vidIn.onchange=()=>{if(vidIn.files[0])loadVid(vidIn.files[0]);vidIn.value='';};

function loadVid(file){
  const url=URL.createObjectURL(file);
  vidEl=document.createElement('video');vidEl.src=url;vidEl.controls=true;vidEl.muted=true;vidEl.playsInline=true;
  vidEl.style.maxWidth='100%';vidEl.style.borderRadius='10px';
  $('vidPV').innerHTML='';$('vidPV').appendChild(vidEl);
  vidEl.onloadedmetadata=()=>{
    const d=vidEl.duration;
    $('vSR').max=d;$('vER').max=d;$('vSR').value=0;$('vER').value=Math.min(d,5);
    updVR();$('vidCtrl').style.display='block';
  };
}

[$('vSR'),$('vER')].forEach(el=>el.oninput=updVR);
$('vidFps').onchange=updVR;$('vidW').oninput=updVR;

function updVR(){
  let s=+$('vSR').value,e=+$('vER').value;
  if(e<=s){e=s+0.5;$('vER').value=e;}
  const dur=e-s,fps=+$('vidFps').value,w=+$('vidW').value;
  const frames=Math.ceil(dur*fps);
  $('vSL').textContent=s.toFixed(1)+'s';$('vEL').textContent=e.toFixed(1)+'s';
  $('vDL').textContent=dur.toFixed(1)+'ì´ˆ';$('vFC').textContent=frames;
  // Rough size estimate: ~2KB per frame at 480px, scales with w^2
  const estKB=frames*(w/480)*(w/480)*2;
  $('vES').textContent=estKB<1024?`~${Math.round(estKB)}KB`:`~${(estKB/1024).toFixed(1)}MB`;
}

$('vidQP').onclick=e=>{
  const b=e.target.closest('.qp-item');if(!b)return;
  document.querySelectorAll('#vidQP .qp-item').forEach(x=>x.classList.remove('active'));
  b.classList.add('active');$('vidW').value=b.dataset.w;$('vidFps').value=b.dataset.fps;updVR();
};

function seekV(v,t){return new Promise(r=>{v.currentTime=t;const h=()=>{v.removeEventListener('seeked',h);r();};v.addEventListener('seeked',h);});}

$('btnVidGen').onclick=async()=>{
  if(!vidEl)return;
  const start=+$('vSR').value,end=+$('vER').value;
  const fps=+$('vidFps').value,w=+$('vidW').value;
  const dither=$('vidDither').checked,useGlobal=$('vidGlobal').checked;
  const dur=end-start,totalF=Math.ceil(dur*fps),delay=Math.round(1000/fps);
  const ratio=vidEl.videoHeight/vidEl.videoWidth,h=Math.round(w*ratio);
  const canvas=document.createElement('canvas');canvas.width=w;canvas.height=h;const ctx=canvas.getContext('2d');

  $('ra').classList.remove('show');showP(0,'í”„ë ˆì„ ì¶”ì¶œ ì¤‘...');

  const pixelDataList=[];
  for(let i=0;i<totalF;i++){
    const t=start+(i/fps);if(t>vidEl.duration)break;
    await seekV(vidEl,t);
    ctx.drawImage(vidEl,0,0,w,h);
    pixelDataList.push(new Uint8Array(ctx.getImageData(0,0,w,h).data));
    showP(Math.round(((i+1)/totalF)*30),`í”„ë ˆì„ ì¶”ì¶œ ${i+1}/${totalF}`);
    if(i%3===0)await yld();
  }
  if(pixelDataList.length<2){hideP();showToast('í”„ë ˆì„ ë¶€ì¡±');return;}

  showP(30,'GIF ì¸ì½”ë”© ì‹œì‘...');
  // samplefac: lower = better quality but slower. 1=best, 30=fastest
  const samplefac = w >= 640 ? 6 : 10;
  try{
    const blob=await encodeWithWorker(pixelDataList,w,h,new Array(pixelDataList.length).fill(delay),0,dither,useGlobal,samplefac);
    showResult(blob);
  }catch(e){hideP();showToast('ì˜¤ë¥˜: '+e.message);}
};

// ===== 3. í™”ë©´ ë…¹í™” =====
let scrStream=null,scrFrames=[],scrRec=false,scrInt=null;
$('btnScrGo').onclick=async()=>{
  try{scrStream=await navigator.mediaDevices.getDisplayMedia({video:true,audio:false});}catch{showToast('ì·¨ì†Œë¨');return;}
  scrRec=true;scrFrames=[];
  $('btnScrGo').style.display='none';$('btnScrStop').style.display='inline-flex';
  $('ra').classList.remove('show');
  const maxDur=+$('scrDur').value*1000,fps=+$('scrFps').value,w=+$('scrW').value;
  const dither=$('scrDither').checked;
  const video=document.createElement('video');video.srcObject=scrStream;video.muted=true;await video.play();
  const ratio=video.videoHeight/video.videoWidth,h=Math.round(w*ratio);
  const canvas=document.createElement('canvas');canvas.width=w;canvas.height=h;const ctx=canvas.getContext('2d');
  const t0=Date.now();
  scrInt=setInterval(()=>{
    if(!scrRec||Date.now()-t0>maxDur){stopScr();return;}
    ctx.drawImage(video,0,0,w,h);
    scrFrames.push(new Uint8Array(ctx.getImageData(0,0,w,h).data));
    $('scrStat').innerHTML=`<span class="rec-dot"></span>ë…¹í™” ${((Date.now()-t0)/1000).toFixed(1)}ì´ˆ Â· ${scrFrames.length}í”„ë ˆì„`;
  },Math.round(1000/fps));
  scrStream.getVideoTracks()[0].onended=()=>stopScr();
};
$('btnScrStop').onclick=()=>stopScr();

async function stopScr(){
  scrRec=false;if(scrInt){clearInterval(scrInt);scrInt=null;}
  if(scrStream){scrStream.getTracks().forEach(t=>t.stop());scrStream=null;}
  $('btnScrGo').style.display='inline-flex';$('btnScrStop').style.display='none';
  if(scrFrames.length<2){$('scrStat').textContent='í”„ë ˆì„ ë¶€ì¡±';return;}
  $('scrStat').textContent='GIF ì¸ì½”ë”© ì¤‘...';
  const fps=+$('scrFps').value,w=+$('scrW').value;
  const dither=$('scrDither').checked;
  const ratio=scrFrames[0].length/4/w,h=Math.round(ratio);
  const delay=Math.round(1000/fps);
  showP(0,'ì¸ì½”ë”© ì¤‘...');
  try{
    const blob=await encodeWithWorker(scrFrames,w,h,new Array(scrFrames.length).fill(delay),0,dither,true,10);
    $('scrStat').textContent='';showResult(blob);
  }catch(e){hideP();$('scrStat').textContent='ì˜¤ë¥˜';showToast('ì˜¤ë¥˜: '+e.message);}
}

// ===== 4. í…ìŠ¤íŠ¸ GIF =====
const txtPV=$('txtPV'),txtPX=txtPV.getContext('2d');
function updTxt(){
  const w=+$('txtW').value,h=+$('txtH').value;txtPV.width=w;txtPV.height=h;
  const text=$('txtC').value||'í…ìŠ¤íŠ¸',sz=+$('txtSz').value;
  txtPX.fillStyle=$('txtBg').value;txtPX.fillRect(0,0,w,h);
  txtPX.fillStyle=$('txtClr').value;txtPX.font=`bold ${sz}px "Noto Sans KR",sans-serif`;
  txtPX.textAlign='center';txtPX.textBaseline='middle';txtPX.fillText(text,w/2,h/2);
}
['txtC','txtSz','txtClr','txtBg','txtW','txtH'].forEach(id=>$(id).addEventListener('input',updTxt));
$('btnTxtPV').onclick=updTxt;

$('btnTxtGen').onclick=async()=>{
  const text=$('txtC').value||'í…ìŠ¤íŠ¸',fx=$('txtFx').value,sz=+$('txtSz').value;
  const color=$('txtClr').value,bg=$('txtBg').value,w=+$('txtW').value,h=+$('txtH').value;
  $('ra').classList.remove('show');showP(0,'í”„ë ˆì„ ìƒì„± ì¤‘...');
  const total=fx==='typewriter'?text.length+8:28;
  const pixelDataList=[];
  for(let i=0;i<total;i++){
    const c=document.createElement('canvas');c.width=w;c.height=h;const ctx=c.getContext('2d');
    ctx.fillStyle=bg;ctx.fillRect(0,0,w,h);ctx.textAlign='center';ctx.textBaseline='middle';
    ctx.font=`bold ${sz}px "Noto Sans KR",sans-serif`;const t=i/total;
    switch(fx){
      case'typewriter':{const n=Math.min(i+1,text.length);ctx.fillStyle=color;ctx.fillText(text.substring(0,n),w/2,h/2);if(n<=text.length&&i%2===0){const tw=ctx.measureText(text.substring(0,n)).width;ctx.fillRect(w/2+tw/2+3,h/2-sz*.4,3,sz*.8);}break;}
      case'bounce':ctx.fillStyle=color;ctx.fillText(text,w/2,h/2-Math.abs(Math.sin(t*Math.PI*3))*h*.22);break;
      case'fade':ctx.globalAlpha=Math.min(t*2.5,1);ctx.fillStyle=color;ctx.fillText(text,w/2,h/2);break;
      case'rainbow':ctx.fillStyle=`hsl(${Math.round(t*360)%360},80%,60%)`;ctx.fillText(text,w/2,h/2);break;
      case'shake':ctx.fillStyle=color;ctx.fillText(text,w/2+(Math.random()-.5)*14,h/2+(Math.random()-.5)*14);break;
      case'slide':{const p=Math.min(t*2,1);const eased=1-Math.pow(1-p,3);ctx.fillStyle=color;ctx.fillText(text,-w+(eased*w*2),h/2);break;}
      case'glow':{const g=Math.abs(Math.sin(t*Math.PI*2));ctx.shadowColor=color;ctx.shadowBlur=g*40;ctx.fillStyle=color;ctx.fillText(text,w/2,h/2);ctx.shadowBlur=0;break;}
      case'wave':{ctx.fillStyle=color;const chars=[...text];let x=w/2-ctx.measureText(text).width/2;for(let ci=0;ci<chars.length;ci++){const yo=Math.sin((t*Math.PI*4)+(ci*0.5))*15;ctx.fillText(chars[ci],x+ctx.measureText(chars[ci]).width/2,h/2+yo);x+=ctx.measureText(chars[ci]).width;}break;}
    }
    pixelDataList.push(new Uint8Array(ctx.getImageData(0,0,w,h).data));
    showP(Math.round(((i+1)/total)*20),`í”„ë ˆì„ ${i+1}/${total}`);
    if(i%3===0)await yld();
  }
  const delay=fx==='typewriter'?180:80;
  try{
    const blob=await encodeWithWorker(pixelDataList,w,h,new Array(total).fill(delay),0,false,true,10);
    showResult(blob);
  }catch(e){hideP();showToast('ì˜¤ë¥˜: '+e.message);}
};

updTxt();
</script>
</body>
</html>
